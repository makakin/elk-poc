input {
  rabbitmq {
    user => "elk"
    password => "elkstackpoc"
    host => "log-broke1.core.gocolumbiamo.com"
    port => 5671
    ssl => true
    durable => true

    key => "Bro-Queue1"
    exchange => "Bro-Queue1"
    exchange_type => "direct"
    queue => "Bro-Queue1"

    tags => [ "bro", "json" ]
#   codec => json_lines { charset => CP1252 }

  }
}

filter {
  if "bro" in [tags]{
    mutate {
      rename => { "Message" => "message" }
    }
  }
}

output {
  elasticsearch {
    hosts => ["https://elk1.core.gocolumbiamo.com:9200", "https://elk2.core.gocolumbiamo.com:9200", "https://elk3.core.gocolumbiamo.com:9200"]
    user => "admin"
    password => "admin"
    index => "lab-wef"
    cacert => "/etc/logstash/pki/chain.pem"
  }
}
